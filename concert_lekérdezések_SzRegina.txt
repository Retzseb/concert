1. Listáz: összes koncert neve, előadója, helyszíne

SELECT 
    c.name AS concert_name,
    p.name AS performer_name,
    pl.name AS place_name,
    pl.city
FROM concerts c
JOIN performers p ON c.performer_id = p.id
JOIN rooms r ON c.room_id = r.id
JOIN places pl ON r.place_id = pl.id;
2.Listáz: felhasználók és fogalalásaik (db)

SELECT 
    u.name AS user_name,
    COUNT(r.id) AS total_reservations
FROM users u
LEFT JOIN reservations r ON u.id = r.user_id
GROUP BY u.id, u.name
ORDER BY total_reservations DESC;
3. Magyar előadók koncertjei:

SELECT 
    c.name AS concert_name,
    p.name AS performer_name,
    p.country
FROM concerts c
JOIN performers p ON c.performer_id = p.id
WHERE p.country = 'Hungary';

4. Minden foglalás a legutóbbi 30 napból:

SELECT 
    id,
    user_id,
    concert_id,
    total_price,
    reservation_date
FROM reservations
WHERE reservation_date >= NOW() - INTERVAL 30 DAY;

5. Melyik koncert hozta a legtöbb bevételt 
(összes jegy alapján)?

SELECT 
    c.name AS concert_name,
    SUM(r.total_price) AS total_revenue
FROM concerts c
JOIN reservations r ON c.id = r.concert_id
GROUP BY c.name
ORDER BY total_revenue DESC
LIMIT 1;

6. Melyik helyszínen tartották a legtöbb koncertet?:

SELECT 
    pl.name AS place_name,
    COUNT(c.id) AS concert_count
FROM places pl
JOIN rooms r ON pl.id = r.place_id
JOIN concerts c ON r.id = c.room_id
GROUP BY pl.id, pl.name
ORDER BY concert_count DESC
LIMIT 1;


7. Listáz: azokat a felhasználókat, 
akik már legalább 2 foglalást csináltak:

SELECT 
    u.name,
    COUNT(r.id) AS reservation_count
FROM users u
JOIN reservations r ON u.id = r.user_id
GROUP BY u.name
HAVING COUNT(r.id) >= 2;

8. Eladott jegyek száma koncertenként:

SELECT 
    c.name AS concert_name,
    COUNT(t.id) AS total_tickets
FROM concerts c
LEFT JOIN reservations r ON c.id = r.concert_id
LEFT JOIN tickets t ON r.id = t.reservation_id
GROUP BY c.name;

9. Azok a koncertek, ahova még nem történt foglalás:
SELECT 
    c.id,
    c.name
FROM concerts c
WHERE NOT EXISTS (
    SELECT 1
    FROM reservations r
    WHERE r.concert_id = c.id
);

10. Melyik műfaj hozta a legtöbb bevételt összesen?

SELECT 
    g.name AS genre_name,
    SUM(r.total_price) AS total_revenue
FROM genres g
JOIN performers p ON g.id = p.genre_id
JOIN concerts c ON p.id = c.performer_id
JOIN reservations r ON c.id = r.concert_id
GROUP BY g.id, g.name
ORDER BY total_revenue DESC;




